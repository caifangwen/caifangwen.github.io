<header class="{{- if site.Params.header.sticky -}}sticky top-0 z-50{{ end }} mx-auto max-w-4xl px-3 py-3 md:px-4 md:py-6">
  <div class="border-border bg-card/80 flex items-center rounded-xl border px-3 py-2 shadow-sm backdrop-blur-sm md:px-6 md:py-4">
    <!-- 桌面端布局 -->
    <div class="hidden w-full items-center md:flex md:min-w-0">
      <!-- 左侧：站点 Logo -->
      <div class="flex items-center">
        {{ if ne site.Params.header.logo.image "" }}
          <a
            href="{{ if site.Params.header.logo.link }}{{ site.Params.header.logo.link | relLangURL }}{{ else }}{{ site.Home.RelPermalink }}{{ end }}"
            class="flex h-9 w-9 items-center justify-center overflow-hidden rounded-full transition-transform duration-200 hover:scale-105 md:h-10 md:w-10"
            aria-label="{{ site.Title }}">
            <img
              src="{{ site.Params.header.logo.image }}"
              alt="{{ site.Title }}"
              class="h-full w-full object-cover" />
          </a>
        {{ else }}
          <a
            href="{{ site.Home.RelPermalink }}"
            class="bg-primary text-primary-foreground hover:bg-primary/90 flex h-9 w-9 items-center justify-center rounded-full text-base font-bold transition-transform duration-200 hover:scale-105 md:h-10 md:w-10 md:text-lg"
            aria-label="{{ site.Title }}">
            {{ substr site.Title 0 1 | upper }}
          </a>
        {{ end }}
      </div>

      <!-- 中间：桌面端导航 -->
      <nav class="mx-4 flex flex-1 items-center justify-center min-w-0 md:mx-8">
        <div class="flex items-center space-x-1 flex-wrap justify-center">
          {{ $currentPage := . }}
          {{ range site.Menus.main }}
            {{ $menuURL := .URL }}
            {{ if .PageRef }}
              {{ with site.GetPage .PageRef }}
                {{ $menuURL = .RelPermalink }}
              {{ else }}
                {{ $menuURL = .URL | relLangURL }}
              {{ end }}
            {{ end }}
            {{ $isActive := eq $currentPage.RelPermalink $menuURL }}
            <a
              href="{{ $menuURL }}"
              class="nav-link {{ if $isActive }}
                nav-active-indicator bg-accent text-accent-foreground
              {{ else }}
                text-muted-foreground hover:text-primary hover:bg-primary/10
              {{ end }} focus:ring-primary/20 relative flex items-center gap-2 rounded-md px-3 py-1.5 text-sm font-medium transition-colors duration-200 focus:ring-2 focus:outline-none">
              {{ if .Params.icon }}
                {{ partial "features/icon.html" (dict "name" .Params.icon "size" "sm" "ariaLabel" .Name) }}
              {{ end }}
              <span>
                {{ if hasPrefix .Name "nav." }}
                  {{ i18n .Name }}
                {{ else }}
                  {{ .Name }}
                {{ end }}
              </span>
            </a>
          {{ end }}
        </div>
      </nav>

      <!-- 右侧：桌面端控制区域 -->
      <div class="flex items-center space-x-1 md:space-x-2">
        {{ partial "ui/language-switcher.html" . }}
        {{ partial "ui/theme-switcher.html" . }}
        {{ partial "ui/dark-mode-switcher.html" . }}
      </div>
    </div>

    <!-- 移动端布局 -->
    <div class="flex w-full items-center justify-between md:hidden">
      {{ partial "navigation/mobile-menu-toggle.html" . }}
      <div class="flex items-center space-x-1">
        {{ partial "ui/language-switcher.html" . }}
        {{ partial "ui/theme-switcher.html" . }}
        {{ partial "ui/dark-mode-switcher.html" . }}
      </div>
    </div>
  </div>
</header>

